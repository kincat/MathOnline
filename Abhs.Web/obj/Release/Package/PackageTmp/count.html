<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=0.72, user-scalable=0.72, minimum-scale=0.72, maximum-scale=0.72,user-scalable=no">
    <title>学生管理</title>
    <link href="Scripts/layui/css/layui.css" rel="stylesheet" />
    <link href="Content/css/animate.min.css" rel="stylesheet" />
    <link href="Content/css/reset.css" rel="stylesheet" />
    <link href="Content/css/style.css" rel="stylesheet" />
    <script src="Scripts/jquery.js"></script>
    <script src="Scripts/layer.js"></script>
    <script src="Scripts/layui/layui.js"></script>
    <script src="Scripts/jquery.nicescroll.js"></script>
    <script src="Scripts/wow.js"></script>
    <script>
			$(function() {
				$('.content4 .niceScrollbox').niceScroll({
					cursorcolor: "#000000", //#CC0071 光标颜色
					cursoropacitymax: .3, //改变不透明度非常光标处于活动状态（scrollabar“可见”状态），范围从1到0
					touchbehavior: false, //使光标拖动滚动像在台式电脑触摸设备
					cursorwidth: "3px", //像素光标的宽度
					cursorborder: "3px solid #000000", // 游标边框css定义
					cursorborderradius: "3px", //以像素为光标边界半径
					autohidemode: true, //是否隐藏滚动条
					railpadding: {
						top: 0,
						right: 18,
						left: 0,
						bottom: 0
					}, //滚动条的位置
				});
				$('.content51 .niceScrollbox').niceScroll({
					cursorcolor: "#000000", //#CC0071 光标颜色
					cursoropacitymax: .3, //改变不透明度非常光标处于活动状态（scrollabar“可见”状态），范围从1到0
					touchbehavior: false, //使光标拖动滚动像在台式电脑触摸设备
					cursorwidth: "3px", //像素光标的宽度
					cursorborder: "3px solid #000000", // 游标边框css定义
					cursorborderradius: "3px", //以像素为光标边界半径
					autohidemode: true, //是否隐藏滚动条
					railpadding: {
						top: 0,
						right: 18,
						left: 0,
						bottom: 0
					}, //滚动条的位置
				});
				$('.content48 li').click(function() {
					$(this).addClass('ljlactive').siblings().removeClass('ljlactive');
				})
				$('.content7 a').click(function(){
					if($('.content6').hasClass('fx')){
						$('.content6').removeClass('fx');
						$(this).html('全屏备课');
						setTimeout(function(){
						   $('.content8 .niceScrollbox').getNiceScroll().resize();
						}, 310);
					}else{
						setTimeout(function(){
						  $('.content8 .niceScrollbox').getNiceScroll().resize();
						}, 310);
						$('.content6').addClass('fx');
						$(this).html('退出全屏')
					}
				});
				$('.content50 .vselect input').click(function(){
					$('.content50 ul').hide();
					$(this).parent('.vselect').find('ul').show();
				})
				$('.content50 .iconspan').click(function(){
					$('.content50 ul').hide();
					$(this).parent('.vselect').find('ul').show();
				})
				$('.content50 li').click(function(){
					$(this).parents('.vselect').find('input').val($(this).html());
					$(this).parents('.vselect').find('ul').hide();
				})
				$('body').click(function(e) {
					if(!$(e.target).hasClass('isclick')){
						$('.content50 ul').hide();
						$('.content51 ul').hide();
					}
				})
				//
				$('.content51 .vselect input').click(function(){
					$('.content51 ul').hide();
					$(this).parent('.vselect').find('ul').show();
				})
				$('.content51 .iconspan').click(function(){
					$('.content51 ul').hide();
					$(this).parent('.vselect').find('ul').show();
				})
				$('.content51 li').click(function(){
					$(this).parents('.vselect').find('input').val($(this).html());
					$(this).parents('.vselect').find('ul').hide();
				})
				layui.use('laydate', function() {
					var laydate = layui.laydate;
					laydate.render({
					    elem: '#begindate',
						range: false,
						done:function(value){
						    $('#begindate').val(value);
						}
					});
					laydate.render({
					    elem: '#enddate',
					    range: false,
						done:function(value){
						    $('#enddate').val(value);
						}
					});
				})
			 
			})
    </script>
    <style>
        body {
            background: #1D2732;
        }
    </style>
</head>
<body>

    <div class="content32"></div>
    <div class="content2">
        <div class="contbox">
            <div class="loginimg fl"><img src="Content/images/adminlogo.png" /></div>
            <div class="headernav fl">
                <div class="ljlactive" href="#">课前备课</div>
                <div class="lessonspage">
                    <div class="lessonscont">
                        <a href="#" class="fl">
                            <div class="navicon"><img src="Content/images/navicon1.png" /></div>
                            <div class="label">课前备课</div>
                        </a>
                        <a href="#" class="fl">
                            <div class="navicon"><img src="Content/images/navicon2.png" /></div>
                            <div class="label">上课管理</div>
                        </a>
                        <a href="#" class="fl">
                            <div class="navicon"><img src="Content/images/navicon3.png" /></div>
                            <div class="label">课后任务</div>
                        </a>
                        <a href="#" class="fl">
                            <div class="navicon"><img src="Content/images/navicon4.png" /></div>
                            <div class="label">班级管理</div>
                        </a>
                        <a href="#" class="fl">
                            <div class="navicon"><img src="Content/images/navicon5.png" /></div>
                            <div class="label">售后</div>
                        </a>
                        <div class="icon"></div>
                    </div>
                </div>
            </div>
            <div class="configbox">
                <div class="quit fr"><img src="Content/images/quit.png" /></div>
                <div class="navbox fr">
                    <img src="Content/images/nav.png" />
                    <div class="listbox">
                        <div>
                            <a href="#">学生管理</a>
                            <a href="#">全部课程</a>
                        </div>
                    </div>
                </div>
                <div class="username fr">张三丰</div>
                <div class="userimg fr"><img src="Content/images/userimg.png" /></div>
            </div>
        </div>
    </div>
    <div class="content3">
        <div class="contbox"></div>
    </div>
    <div class="content4">
        <div class="ljltitle">学生分类</div>
        <div class="niceScrollbox">
            <div class="content48">
                <div class="contbox">
                    <ul>
                        <li class="ljlactive">
                            <a href="#">
                                <div class="righticon"><img src="Content/images/rightico.png"></div>
                                <div class="studenttype">已分班学生</div>
                                <div class="studenttype1">
                                    <span>(总共：100人)</span>
                                    <em>(将到期：14人)</em>
                                </div>
                            </a>
                        </li>
                        <li class="">
                            <a href="#">
                                <div class="righticon"><img src="Content/images/rightico.png"></div>
                                <div class="studenttype">已分班学生</div>
                                <div class="studenttype1">
                                    <span>(总共：100人)</span>
                                    <em>(将到期：14人)</em>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <div class="content6 content49">
        <div class="content7">
            <div class="contbox">
                <div class="label fl">已分班学生列表</div>
                <a href="#">全屏备课</a>
            </div>
        </div>
        <div class="content50">
            <div class="contbox">
                <div class="ftitle">
                    总共:10人丨即将到期：<span>4人</span>
                    <a href="#">刷新列表</a>
                </div>
                <div id="testhtml"></div>
                <div class="seachbox">
                    <div class="ljllist">
                        <div class="inpbox dateinp">
                            <input id="begindate" type="text" placeholder="开始日期" />
                            <span class="iconspan"><img src="Content/images/dateimg.png" /></span>
                        </div>
                    </div>
                    <div class="ljllist">
                        <div class="inpbox dateinp">
                            <input id="enddate" type="text" placeholder="结束日期" />
                            <span class="iconspan"><img src="Content/images/dateimg.png" /></span>
                        </div>
                    </div>
                    <div class="ljllist">
                        <a class="subbtn" href="#" id="search">搜 索</a>
                        <a class="subbtn" href="javascript:;" onclick="layUIExport()">导出</a>
                    </div>
                    <div style="clear: both;"></div>
                </div>
                <div class="mytable">
                    <table align="center" class="layui-table" id="test"  lay-filter="test"></table>
                </div>
            </div>
        </div>
    </div>
    <div class="content51">
        <div class="box">
            <div class="ftitle"><label class="fl">分配班级</label><span></span></div>
            <div class="contbox">
                <div class="userpic">
                    <img src="Content/images/userimg.png">
                </div>
                <div class="userinfo fl">
                    <div class="username">
                        张无忌
                        <em>(小学)</em>
                    </div>
                    <div class="userconfig">
                        <i>注册时间：</i>2020-03-23  丨   <i>到期时间：</i>2021-03-23
                    </div>
                </div>
            </div>
            <div class="inplist">
                <div class="ljllist">
                    <div class="inpbox vselect classtime">
                        <input class="isclick" type="text" placeholder="全部年级" />
                        <ul>
                            <li class="isclick">一年级</li>
                            <li class="isclick">二年级</li>
                            <li class="isclick">三年级</li>
                            <li class="isclick">四年级</li>
                            <li class="isclick">五年级</li>
                            <li class="isclick">六年级</li>
                            <li class="isclick">初一年级</li>
                            <li class="isclick">初二年级</li>
                            <li class="isclick">初三年级</li>
                            <li class="isclick">高一年级</li>
                            <li class="isclick">高二年级</li>
                            <li class="isclick">高三年级</li>
                        </ul>
                        <span class="iconspan isclick"><img src="Content/images/hxl.png" /></span>
                    </div>
                </div>
                <div class="ljllist">
                    <div class="inpbox vselect classtime">
                        <input class="isclick" type="text" placeholder="全部版本" />
                        <ul>
                            <li class="isclick">男</li>
                            <li class="isclick">女</li>
                        </ul>
                        <span class="iconspan isclick"><img src="Content/images/hxl.png" /></span>
                    </div>
                </div>
                <div class="ljllist">
                    <div class="inpbox vselect classtime">
                        <input class="isclick" type="text" placeholder="全部班级" />
                        <ul>
                            <li class="isclick">一班</li>
                            <li class="isclick">二班</li>
                            <li class="isclick">三班</li>
                        </ul>
                
                        <span class="iconspan isclick"><img src="Content/images/hxl.png" /></span>
                    </div>
                </div>
            </div>
            <div class="niceScrollbox">
                <div class="classbox">
                    <div class="classlist">
                        <div class="classname">
                            <label class="fl">ID:123458</label>
                            <div class="line1">七年级秋季班七年级秋季班七年级秋季班七年级秋季班（2020-03-01~2020-06-07）</div>
                        </div>
                        <div class="classinfo">
                            <div class="infotext">
                                <span><i>校区老师：</i>李老师</span><span><i>课程名称：</i>七年级同步课（16课时）</span><span><i>教材版本：</i>人教版人教版人教</span>
                            </div>
                        </div>
                        <div class="studytime">
                            <label class="fl">上课时间：</label>
                            <div class="studytimelist">
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                            </div>
                        </div>
                        <div class="classinfo classinfo1">
                            <div class="infotext">
                                <span><i>班级人数：</i>10人</span>
                                <a href="#">加入班级</a>
                            </div>
                        </div>
                    </div>
                    <div class="classlist">
                        <div class="classname">
                            <label class="fl">ID:123458</label>
                            <div class="line1">七年级秋季班七年级秋季班七年级秋季班七年级秋季班（2020-03-01~2020-06-07）</div>
                        </div>
                        <div class="classinfo">
                            <div class="infotext">
                                <span><i>校区老师：</i>李老师</span><span><i>课程名称：</i>七年级同步课（16课时）</span><span><i>教材版本：</i>人教版人教版人教</span>
                            </div>
                        </div>
                        <div class="studytime">
                            <label class="fl">上课时间：</label>
                            <div class="studytimelist">
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                            </div>
                        </div>
                        <div class="classinfo classinfo1">
                            <div class="infotext">
                                <span><i>班级人数：</i>10人</span>
                                <a href="#">加入班级</a>
                            </div>
                        </div>
                    </div>
                    <div class="classlist">
                        <div class="classname">
                            <label class="fl">ID:123458</label>
                            <div class="line1">七年级秋季班七年级秋季班七年级秋季班七年级秋季班（2020-03-01~2020-06-07）</div>
                        </div>
                        <div class="classinfo">
                            <div class="infotext">
                                <span><i>校区老师：</i>李老师</span><span><i>课程名称：</i>七年级同步课（16课时）</span><span><i>教材版本：</i>人教版人教版人教</span>
                            </div>
                        </div>
                        <div class="studytime">
                            <label class="fl">上课时间：</label>
                            <div class="studytimelist">
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                            </div>
                        </div>
                        <div class="classinfo classinfo1">
                            <div class="infotext">
                                <span><i>班级人数：</i>10人</span>
                                <a href="#">加入班级</a>
                            </div>
                        </div>
                    </div>
                    <div class="classlist">
                        <div class="classname">
                            <label class="fl">ID:123458</label>
                            <div class="line1">七年级秋季班七年级秋季班七年级秋季班七年级秋季班（2020-03-01~2020-06-07）</div>
                        </div>
                        <div class="classinfo">
                            <div class="infotext">
                                <span><i>校区老师：</i>李老师</span><span><i>课程名称：</i>七年级同步课（16课时）</span><span><i>教材版本：</i>人教版人教版人教</span>
                            </div>
                        </div>
                        <div class="studytime">
                            <label class="fl">上课时间：</label>
                            <div class="studytimelist">
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                            </div>
                        </div>
                        <div class="classinfo classinfo1">
                            <div class="infotext">
                                <span><i>班级人数：</i>10人</span>
                                <a href="#">加入班级</a>
                            </div>
                        </div>
                    </div>
                    <div class="classlist">
                        <div class="classname">
                            <label class="fl">ID:123458</label>
                            <div class="line1">七年级秋季班七年级秋季班七年级秋季班七年级秋季班（2020-03-01~2020-06-07）</div>
                        </div>
                        <div class="classinfo">
                            <div class="infotext">
                                <span><i>校区老师：</i>李老师</span><span><i>课程名称：</i>七年级同步课（16课时）</span><span><i>教材版本：</i>人教版人教版人教</span>
                            </div>
                        </div>
                        <div class="studytime">
                            <label class="fl">上课时间：</label>
                            <div class="studytimelist">
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                            </div>
                        </div>
                        <div class="classinfo classinfo1">
                            <div class="infotext">
                                <span><i>班级人数：</i>10人</span>
                                <a href="#">加入班级</a>
                            </div>
                        </div>
                    </div>
                    <div class="classlist">
                        <div class="classname">
                            <label class="fl">ID:123458</label>
                            <div class="line1">七年级秋季班七年级秋季班七年级秋季班七年级秋季班（2020-03-01~2020-06-07）</div>
                        </div>
                        <div class="classinfo">
                            <div class="infotext">
                                <span><i>校区老师：</i>李老师</span><span><i>课程名称：</i>七年级同步课（16课时）</span><span><i>教材版本：</i>人教版人教版人教</span>
                            </div>
                        </div>
                        <div class="studytime">
                            <label class="fl">上课时间：</label>
                            <div class="studytimelist">
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周六10:00~12:00</span>
                                <span>周日14:00~16:00</span>
                                <span>周日14:00~16:00</span>
                            </div>
                        </div>
                        <div class="classinfo classinfo1">
                            <div class="infotext">
                                <span><i>班级人数：</i>10人</span>
                                <a href="#">加入班级</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
          
        </div>
    </div>
    <script>
        var data = {};
        function layUIExport() {
           
            var ins1 = table.render({
                elem: '#test',
                url: '/Home/GetCount',
                defaultToolbar: ['filter', 'print', 'exports', {
                    title: '提示' //标题
                    , layEvent: 'LAYTABLE_TIPS' //事件名，用于 toolbar 事件中使用
                    , icon: 'layui-icon-tips' //图标类名
                }],
                height: 'full-340',
                cellMinWidth: 80,
                limit: 1000,
                method: 'post',
                page: { //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                    layout: ['prev', 'page', 'next', 'count'], //自定义分页布局
                    curr: 1, //设定初始在第 5 页
                    groups: 5,//只显示 1 个连续页码
                    first: true,//不显示首页
                    last: true, //不显示尾页
                    next: '下一页',
                    prev: '上一页'

                },
                done: function (res, curr, count) {
                    exportData = res.data;
                    table.exportFile(ins1.config.id, exportData, 'xls');
                },
                cols: [
                   tableCols
                ],
            });
 
        }
        getCols();
        var temp = [{
            field: 'schoolId',
            width: 120,
            title: 'schoolId',
            sort: true,

        }, {
            field: 'name',
            width: 150,
            title: '学校名称'
        }, {
            field: 'manager',
            width: 150,
            title: '校长'
        }, {
            field: 'allCount',
            width: 120,
            title: '所有数量',
            sort: true
        }, {
            field: 'count',
            width: 120,
            title: '学生使用数量',
            sort: true
        }
        ];
        var tableCols = temp;
       
            $('#search').on('click', function () {

                search()
            });
       
        //setInterval(function () {

        //    test();
        //}, 5000)
        //test()
            var table;
        function getCols() {
            $.ajax({
                url: "/Home/GetCols",
                type: "post",
                dataType: "json",
                data:   {
                'regBeginDate': $("#begindate").val(),
                'regEndDate': $("#enddate").val()
                },
                success: function (data) {
                   
                    tableCols = new Array();
                    tableCols = temp;
                    $.each(data, function (index, value) {
                        var obj = {};
                        obj.field = value,
                        obj.width = 100,
                        obj.title = value;
                        tableCols.push(obj);
                    });
                    layui.use(['table'], function() {
                        table = layui.table;
                        table.render({
                            elem: '#test',
                            url: '/Home/GetCount',
                            defaultToolbar: ['filter', 'print', 'exports', {
                                title: '提示' //标题
                                ,layEvent: 'LAYTABLE_TIPS' //事件名，用于 toolbar 事件中使用
                                ,icon: 'layui-icon-tips' //图标类名
                            }],
                            height: 'full-340',
                            cellMinWidth: 80,
                            limit: 1000,
                            method: 'post',
                            page:{ //支持传入 laypage 组件的所有参数（某些参数除外，如：jump/elem） - 详见文档
                                layout: ['prev', 'page', 'next', 'count'], //自定义分页布局
                                curr: 1, //设定初始在第 5 页
                                groups: 5 ,//只显示 1 个连续页码
                                first: true ,//不显示首页
                                last: true, //不显示尾页
                                next:'下一页',
                                prev:'上一页'

                            },
                            done: function (res, curr, count) {
                                data=res.data
                            },
                            cols: [
                               tableCols
                            ],
                        });
                    })
                },
                error: function (errorMsg) {
                    //console.log(JSON.stringify(errorMsg))
                    //layer.msg("出错了，请刷新再尝试");
                }
            });
        }

        function search() {
            table.reload('test', {
                method: 'post'
                      , where: {
                          'regBeginDate': $("#begindate").val(),
                          'regEndDate': $("#enddate").val()
                      }
                      , cols: [
                               tableCols
                      ], page: {
                          curr: 1
                      }, done: function (res, curr, count) {
                          data = res.data
                      }
            });
        }
    </script>
</body>
</html>
